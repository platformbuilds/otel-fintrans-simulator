# Fully-loaded simulator configuration (all KPIs + labels + scenarios)
telemetry:
  service_names:
    api_gateway: "api-gateway"
    tps: "tps"
    cassandra_client: "cassandra-client"
    keydb_client: "keydb-client"
    kafka_producer: "kafka-producer"
    kafka_consumer: "kafka-consumer"
    payment_orchestration: "payment-orch"
    fraud_service: "fraud-service"

  metric_names:
    # core transaction metrics
    transactions_total: "transactions_total"
    transactions_failed_total: "transactions_failed_total"
    transaction_latency_seconds: "transaction_latency_seconds"
    transaction_amount_paisa_sum: "transaction_amount_paisa_sum"
    transaction_amount_paisa_count: "transaction_amount_paisa_count"

    # DB metrics
    db_ops_total: "db_ops_total"
    db_latency_seconds: "db_latency_seconds"

    # Kafka metrics
    kafka_produce_total: "kafka_produce_total"
    kafka_consume_total: "kafka_consume_total"
    kafka_controller_UnderReplicatedPartitions: "kafka_controller_UnderReplicatedPartitions"
    kafka_network_RequestMetrics_RequestsPerSec: "kafka_network_RequestMetrics_RequestsPerSec"
    kafka_server_BrokerTopicMetrics_BytesInPerSec: "kafka_server_BrokerTopicMetrics_BytesInPerSec"

    # JVM & GC
    jvm_memory_used_bytes: "jvm_memory_used_bytes"
    jvm_memory_max_bytes: "jvm_memory_max_bytes"
    jvm_gc_pause_seconds_sum: "jvm_gc_pause_seconds_sum"
    jvm_gc_pause_seconds_count: "jvm_gc_pause_seconds_count"

    # Tomcat
    tomcat_threads_busy_threads: "tomcat_threads_busy_threads"
    tomcat_threads_config_max_threads: "tomcat_threads_config_max_threads"
    tomcat_threads_queue_seconds: "tomcat_threads_queue_seconds"

    # Process / Node exporter
    process_cpu_usage: "process_cpu_usage"
    process_uptime_seconds: "process_uptime_seconds"
    process_files_open_files: "process_files_open_files"
    process_files_max_files: "process_files_max_files"
    node_load1: "node_load1"
    node_memory_MemAvailable_bytes: "node_memory_MemAvailable_bytes"
    node_memory_MemTotal_bytes: "node_memory_MemTotal_bytes"
    node_filesystem_avail_bytes: "node_filesystem_avail_bytes"
    node_filesystem_size_bytes: "node_filesystem_size_bytes"

    # Hikari
    hikaricp_connections_active: "hikaricp_connections_active"
    hikaricp_connections_max: "hikaricp_connections_max"

    # Redis/KeyDB
    redis_memory_used_bytes: "redis_memory_used_bytes"
    redis_memory_max_bytes: "redis_memory_max_bytes"
    redis_keyspace_hits_total: "redis_keyspace_hits_total"
    redis_keyspace_misses_total: "redis_keyspace_misses_total"
    redis_evicted_keys_total: "redis_evicted_keys_total"
    redis_master_repl_offset: "redis_master_repl_offset"
    redis_slave_repl_offset: "redis_slave_repl_offset"

    # add any extra names you want to override
    additional:
      tomcat_threads_pool_size: "tomcat_threads_pool_size"
      application_custom_kpi_1: "app_custom_kpi_1"

  labels:
    # Example label sets cover different orgs and txn types â€” keep cardinality small
    org_ids: ["bank_01", "bank_02", "bank_03", "bank_04"]
    org_names: ["BankOne", "BankTwo", "BankThree", "BankFour"]
    transaction_types: ["merchant_payment", "p2p", "bill_payment", "topup"]
    regions: ["eu-west-1", "ap-south-1", "us-east-1"]

  outputs: ["otlp"]
  endpoint: "127.0.0.1:4317"
  insecure: true

failure:
  mode: "bursty"
  rate: 0.05
  seed: 98765
  bursts:
    - start: "10s"
      duration: "30s"
      multiplier: 3.0
    - start: "3m"
      duration: "1m"
      multiplier: 2.0

  scenarios:
    - name: "full_stack_kpi_stress"
      start: "5s"
      duration: "3m"
      labels:
        OrgId: ["bank_01", "bank_02"]
      effects:
        - metric: "db_latency"
          op: "scale"
          value: 4.0
        - metric: "transaction_latency_seconds"
          op: "scale"
          value: 2.5
        - metric: "jvm_gc"
          op: "scale"
          value: 3.0
        - metric: "transaction_failures"
          op: "scale"
          value: 3.0

    - name: "redis_memory_bloat"
      start: "20s"
      duration: "90s"
      labels:
        OrgId: ["bank_03"]
      effects:
        - metric: "redis_memory"
          op: "scale"
          value: 2.0
        - metric: "redis_evicted_keys_total"
          op: "add"
          value: 20

    - name: "tomcat_thread_ramp"
      start: "15s"
      duration: "2m"
      labels:
        OrgId: ["bank_02", "bank_04"]
      effects:
        - metric: "tomcat_threads"
          op: "ramp"
          step: 2
        - metric: "tomcat_threads_queue_seconds"
          op: "add"
          value: 5

    - name: "kafka_underreplicated_burst"
      start: "30s"
      duration: "1m"
      labels:
        OrgId: ["bank_01", "bank_03"]
      effects:
        - metric: "kafka_controller_UnderReplicatedPartitions"
          op: "add"
          value: 5
        - metric: "transaction_failures"
          op: "scale"
          value: 6.0

    - name: "partial_outage_bank03"
      start: "60s"
      duration: "2m"
      labels:
        OrgId: ["bank_03"]
      effects:
        - metric: "kafka_controller_UnderReplicatedPartitions"
          op: "add"
          value: 3
        - metric: "db_latency"
          op: "scale"
          value: 6.0
        - metric: "transaction_failures"
          op: "scale"
          value: 8.0

    # hardware-failure style scenarios (disk / memory faults)
    - name: "kafka_disk_issue"
      start: "75s"
      duration: "90s"
      labels:
        OrgId: ["bank_01"]
      effects:
        - metric: "kafka_disk_failure"
          op: "scale"
          value: 4.0
        - metric: "kafka_controller_UnderReplicatedPartitions"
          op: "add"
          value: 10

    - name: "keydb_memory_corruption"
      start: "90s"
      duration: "2m"
      labels:
        OrgId: ["bank_02"]
      effects:
        - metric: "keydb_memory_fault"
          op: "scale"
          value: 5.0
        - metric: "redis_memory"
          op: "scale"
          value: 2.5

    - name: "network_packet_loss"
      start: "30s"
      duration: "90s"
      labels:
        OrgId: ["bank_03"]
      effects:
        - metric: "network_packet_drop"
          op: "scale"
          value: 6.0
        - metric: "node_network_packet_drops_total"
          op: "add"
          value: 10

    - name: "network_latency_spike"
      start: "45s"
      duration: "1m30s"
      labels:
        OrgId: ["bank_02"]
      effects:
        - metric: "network_latency"
          op: "scale"
          value: 5.0

# End fully-loaded config
